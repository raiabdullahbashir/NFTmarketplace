{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getNonCompliantApprovalAddress = exports.onDeprecated = exports.validateAndFormatWalletAddress = exports.delay = exports.assignOrdersToSides = exports.getOrderHash = exports.getWyvernBundle = exports.getWyvernAsset = exports.estimateCurrentPrice = exports.getTransferFeeSettings = exports.getCurrentGasPrice = exports.estimateGas = exports.rawCall = exports.sendRawTransaction = exports.makeBigNumber = exports.isContractAddress = exports.personalSignAsync = exports.orderToJSON = exports.orderFromJSON = exports.tokenFromJSON = exports.collectionFromJSON = exports.assetContractFromJSON = exports.assetBundleFromJSON = exports.userFromJSON = exports.accountFromJSON = exports.transactionFromJSON = exports.assetEventFromJSON = exports.assetFromJSON = exports.confirmTransaction = exports.promisifyCall = exports.annotateERC20TransferABI = exports.annotateERC721TransferABI = exports.WyvernProtocol = void 0;\n\nvar bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\n\nvar ethUtil = __importStar(require(\"ethereumjs-util\"));\n\nvar _ = __importStar(require(\"lodash\"));\n\nvar Web3 = __importStar(require(\"web3\"));\n\nvar wyvern_js_1 = require(\"wyvern-js\");\n\nObject.defineProperty(exports, \"WyvernProtocol\", {\n  enumerable: true,\n  get: function () {\n    return wyvern_js_1.WyvernProtocol;\n  }\n});\n\nvar types_1 = require(\"wyvern-schemas/dist/types\");\n\nvar constants_1 = require(\"../constants\");\n\nvar contracts_1 = require(\"../contracts\");\n\nvar types_2 = require(\"../types\");\n\nvar annotateERC721TransferABI = function (asset) {\n  return {\n    constant: false,\n    inputs: [{\n      name: \"_to\",\n      type: \"address\",\n      kind: types_1.FunctionInputKind.Replaceable\n    }, {\n      name: \"_tokenId\",\n      type: \"uint256\",\n      kind: types_1.FunctionInputKind.Asset,\n      value: asset.id\n    }],\n    target: asset.address,\n    name: \"transfer\",\n    outputs: [],\n    payable: false,\n    stateMutability: types_1.StateMutability.Nonpayable,\n    type: Web3.AbiType.Function\n  };\n};\n\nexports.annotateERC721TransferABI = annotateERC721TransferABI;\n\nvar annotateERC20TransferABI = function (asset) {\n  return {\n    constant: false,\n    inputs: [{\n      name: \"_to\",\n      type: \"address\",\n      kind: types_1.FunctionInputKind.Replaceable\n    }, {\n      name: \"_amount\",\n      type: \"uint256\",\n      kind: types_1.FunctionInputKind.Count,\n      value: asset.quantity\n    }],\n    target: asset.address,\n    name: \"transfer\",\n    outputs: [{\n      name: \"success\",\n      type: \"bool\",\n      kind: types_1.FunctionOutputKind.Other\n    }],\n    payable: false,\n    stateMutability: types_1.StateMutability.Nonpayable,\n    type: Web3.AbiType.Function\n  };\n};\n\nexports.annotateERC20TransferABI = annotateERC20TransferABI; // OTHER\n\nvar txCallbacks = {};\n/**\n * Promisify a callback-syntax web3 function\n * @param inner callback function that accepts a Web3 callback function and passes\n * it to the Web3 function\n */\n\nfunction promisify(inner) {\n  return __awaiter(this, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      return [2\n      /*return*/\n      , new Promise(function (resolve, reject) {\n        return inner(function (err, res) {\n          if (err) {\n            reject(err);\n          }\n\n          resolve(res);\n        });\n      })];\n    });\n  });\n}\n/**\n * Promisify a call a method on a contract,\n * handling Parity errors. Returns '0x' if error.\n * Note that if T is not \"string\", this may return a falsey\n * value when the contract doesn't support the method (e.g. `isApprovedForAll`).\n * @param callback An anonymous function that takes a web3 callback\n * and returns a Web3 Contract's call result, e.g. `c => erc721.ownerOf(3, c)`\n * @param onError callback when user denies transaction\n */\n\n\nfunction promisifyCall(callback, onError) {\n  return __awaiter(this, void 0, void 0, function () {\n    var result, error_1;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          _a.trys.push([0, 2,, 3]);\n\n          return [4\n          /*yield*/\n          , promisify(callback)];\n\n        case 1:\n          result = _a.sent();\n\n          if (typeof result === \"string\" && result == \"0x\") {\n            // Geth compatibility\n            return [2\n            /*return*/\n            , undefined];\n          }\n\n          return [2\n          /*return*/\n          , result];\n\n        case 2:\n          error_1 = _a.sent(); // Probably method not found, and web3 is a Parity node\n\n          if (onError) {\n            onError(error_1);\n          } else {\n            console.error(error_1);\n          }\n\n          return [2\n          /*return*/\n          , undefined];\n\n        case 3:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nexports.promisifyCall = promisifyCall;\n\nvar track = function (web3, txHash, onFinalized) {\n  if (txCallbacks[txHash]) {\n    txCallbacks[txHash].push(onFinalized);\n  } else {\n    txCallbacks[txHash] = [onFinalized];\n\n    var poll_1 = function () {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var tx, receipt, status_1;\n        return __generator(this, function (_a) {\n          switch (_a.label) {\n            case 0:\n              return [4\n              /*yield*/\n              , promisify(function (c) {\n                return web3.eth.getTransaction(txHash, c);\n              })];\n\n            case 1:\n              tx = _a.sent();\n              if (!(tx && tx.blockHash && tx.blockHash !== constants_1.NULL_BLOCK_HASH)) return [3\n              /*break*/\n              , 3];\n              return [4\n              /*yield*/\n              , promisify(function (c) {\n                return web3.eth.getTransactionReceipt(txHash, c);\n              })];\n\n            case 2:\n              receipt = _a.sent();\n\n              if (!receipt) {\n                // Hack: assume success if no receipt\n                console.warn(\"No receipt found for \", txHash);\n              }\n\n              status_1 = receipt ? parseInt((receipt.status || \"0\").toString()) == 1 : true;\n              txCallbacks[txHash].map(function (f) {\n                return f(status_1);\n              });\n              delete txCallbacks[txHash];\n              return [3\n              /*break*/\n              , 4];\n\n            case 3:\n              setTimeout(poll_1, 1000);\n              _a.label = 4;\n\n            case 4:\n              return [2\n              /*return*/\n              ];\n          }\n        });\n      });\n    };\n\n    poll_1().catch();\n  }\n};\n\nvar confirmTransaction = function (web3, txHash) {\n  return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      return [2\n      /*return*/\n      , new Promise(function (resolve, reject) {\n        track(web3, txHash, function (didSucceed) {\n          if (didSucceed) {\n            resolve(\"Transaction complete!\");\n          } else {\n            reject(new Error(\"Transaction failed :( You might have already completed this action. See more on the mainnet at etherscan.io/tx/\".concat(txHash)));\n          }\n        });\n      })];\n    });\n  });\n};\n\nexports.confirmTransaction = confirmTransaction; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar assetFromJSON = function (asset) {\n  var isAnimated = asset.image_url && asset.image_url.endsWith(\".gif\");\n  var isSvg = asset.image_url && asset.image_url.endsWith(\".svg\");\n  var fromJSON = {\n    tokenId: asset.token_id.toString(),\n    tokenAddress: asset.asset_contract.address,\n    name: asset.name,\n    description: asset.description,\n    owner: asset.owner,\n    assetContract: (0, exports.assetContractFromJSON)(asset.asset_contract),\n    collection: (0, exports.collectionFromJSON)(asset.collection),\n    orders: asset.orders ? asset.orders.map(exports.orderFromJSON) : null,\n    sellOrders: asset.sell_orders ? asset.sell_orders.map(exports.orderFromJSON) : null,\n    buyOrders: asset.buy_orders ? asset.buy_orders.map(exports.orderFromJSON) : null,\n    isPresale: asset.is_presale,\n    // Don't use previews if it's a special image\n    imageUrl: isAnimated || isSvg ? asset.image_url : asset.image_preview_url || asset.image_url,\n    imagePreviewUrl: asset.image_preview_url,\n    imageUrlOriginal: asset.image_original_url,\n    imageUrlThumbnail: asset.image_thumbnail_url,\n    externalLink: asset.external_link,\n    openseaLink: asset.permalink,\n    traits: asset.traits,\n    numSales: asset.num_sales,\n    lastSale: asset.last_sale ? (0, exports.assetEventFromJSON)(asset.last_sale) : null,\n    backgroundColor: asset.background_color ? \"#\".concat(asset.background_color) : null,\n    transferFee: asset.transfer_fee ? makeBigNumber(asset.transfer_fee) : null,\n    transferFeePaymentToken: asset.transfer_fee_payment_token ? (0, exports.tokenFromJSON)(asset.transfer_fee_payment_token) : null\n  }; // If orders were included, put them in sell/buy order groups\n\n  if (fromJSON.orders && !fromJSON.sellOrders) {\n    fromJSON.sellOrders = fromJSON.orders.filter(function (o) {\n      return o.side == types_2.OrderSide.Sell;\n    });\n  }\n\n  if (fromJSON.orders && !fromJSON.buyOrders) {\n    fromJSON.buyOrders = fromJSON.orders.filter(function (o) {\n      return o.side == types_2.OrderSide.Buy;\n    });\n  }\n\n  return fromJSON;\n};\n\nexports.assetFromJSON = assetFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar assetEventFromJSON = function (assetEvent) {\n  return {\n    eventType: assetEvent.event_type,\n    eventTimestamp: assetEvent.event_timestamp,\n    auctionType: assetEvent.auction_type,\n    totalPrice: assetEvent.total_price,\n    transaction: assetEvent.transaction ? (0, exports.transactionFromJSON)(assetEvent.transaction) : null,\n    paymentToken: assetEvent.payment_token ? (0, exports.tokenFromJSON)(assetEvent.payment_token) : null\n  };\n};\n\nexports.assetEventFromJSON = assetEventFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar transactionFromJSON = function (transaction) {\n  return {\n    fromAccount: (0, exports.accountFromJSON)(transaction.from_account),\n    toAccount: (0, exports.accountFromJSON)(transaction.to_account),\n    createdDate: new Date(\"\".concat(transaction.created_date, \"Z\")),\n    modifiedDate: new Date(\"\".concat(transaction.modified_date, \"Z\")),\n    transactionHash: transaction.transaction_hash,\n    transactionIndex: transaction.transaction_index,\n    blockNumber: transaction.block_number,\n    blockHash: transaction.block_hash,\n    timestamp: new Date(\"\".concat(transaction.timestamp, \"Z\"))\n  };\n};\n\nexports.transactionFromJSON = transactionFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar accountFromJSON = function (account) {\n  return {\n    address: account.address,\n    config: account.config,\n    profileImgUrl: account.profile_img_url,\n    user: account.user ? (0, exports.userFromJSON)(account.user) : null\n  };\n};\n\nexports.accountFromJSON = accountFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar userFromJSON = function (user) {\n  return {\n    username: user.username\n  };\n};\n\nexports.userFromJSON = userFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar assetBundleFromJSON = function (asset_bundle) {\n  var fromJSON = {\n    maker: asset_bundle.maker,\n    assets: asset_bundle.assets.map(exports.assetFromJSON),\n    assetContract: asset_bundle.asset_contract ? (0, exports.assetContractFromJSON)(asset_bundle.asset_contract) : undefined,\n    name: asset_bundle.name,\n    slug: asset_bundle.slug,\n    description: asset_bundle.description,\n    externalLink: asset_bundle.external_link,\n    permalink: asset_bundle.permalink,\n    sellOrders: asset_bundle.sell_orders ? asset_bundle.sell_orders.map(exports.orderFromJSON) : null\n  };\n  return fromJSON;\n};\n\nexports.assetBundleFromJSON = assetBundleFromJSON;\n\nvar assetContractFromJSON = function ( // eslint-disable-next-line @typescript-eslint/no-explicit-any\nasset_contract) {\n  return {\n    name: asset_contract.name,\n    description: asset_contract.description,\n    type: asset_contract.asset_contract_type,\n    schemaName: asset_contract.schema_name,\n    address: asset_contract.address,\n    tokenSymbol: asset_contract.symbol,\n    buyerFeeBasisPoints: +asset_contract.buyer_fee_basis_points,\n    sellerFeeBasisPoints: +asset_contract.seller_fee_basis_points,\n    openseaBuyerFeeBasisPoints: +asset_contract.opensea_buyer_fee_basis_points,\n    openseaSellerFeeBasisPoints: +asset_contract.opensea_seller_fee_basis_points,\n    devBuyerFeeBasisPoints: +asset_contract.dev_buyer_fee_basis_points,\n    devSellerFeeBasisPoints: +asset_contract.dev_seller_fee_basis_points,\n    imageUrl: asset_contract.image_url,\n    externalLink: asset_contract.external_link,\n    wikiLink: asset_contract.wiki_link\n  };\n};\n\nexports.assetContractFromJSON = assetContractFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar collectionFromJSON = function (collection) {\n  var createdDate = new Date(\"\".concat(collection.created_date, \"Z\"));\n  return {\n    createdDate: createdDate,\n    name: collection.name,\n    description: collection.description,\n    slug: collection.slug,\n    editors: collection.editors,\n    hidden: collection.hidden,\n    featured: collection.featured,\n    featuredImageUrl: collection.featured_image_url,\n    displayData: collection.display_data,\n    paymentTokens: (collection.payment_tokens || []).map(exports.tokenFromJSON),\n    openseaBuyerFeeBasisPoints: +collection.opensea_buyer_fee_basis_points,\n    openseaSellerFeeBasisPoints: +collection.opensea_seller_fee_basis_points,\n    devBuyerFeeBasisPoints: +collection.dev_buyer_fee_basis_points,\n    devSellerFeeBasisPoints: +collection.dev_seller_fee_basis_points,\n    payoutAddress: collection.payout_address,\n    imageUrl: collection.image_url,\n    largeImageUrl: collection.large_image_url,\n    stats: collection.stats,\n    traitStats: collection.traits,\n    externalLink: collection.external_url,\n    wikiLink: collection.wiki_url\n  };\n};\n\nexports.collectionFromJSON = collectionFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar tokenFromJSON = function (token) {\n  var fromJSON = {\n    name: token.name,\n    symbol: token.symbol,\n    decimals: token.decimals,\n    address: token.address,\n    imageUrl: token.image_url,\n    ethPrice: token.eth_price,\n    usdPrice: token.usd_price\n  };\n  return fromJSON;\n};\n\nexports.tokenFromJSON = tokenFromJSON; // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\nvar orderFromJSON = function (order) {\n  var createdDate = new Date(\"\".concat(order.created_date, \"Z\"));\n  var fromJSON = {\n    hash: order.order_hash || order.hash,\n    cancelledOrFinalized: order.cancelled || order.finalized,\n    markedInvalid: order.marked_invalid,\n    metadata: order.metadata,\n    quantity: new bignumber_js_1.default(order.quantity || 1),\n    exchange: order.exchange,\n    makerAccount: order.maker,\n    takerAccount: order.taker,\n    // Use string address to conform to Wyvern Order schema\n    maker: order.maker.address,\n    taker: order.taker.address,\n    makerRelayerFee: new bignumber_js_1.default(order.maker_relayer_fee),\n    takerRelayerFee: new bignumber_js_1.default(order.taker_relayer_fee),\n    makerProtocolFee: new bignumber_js_1.default(order.maker_protocol_fee),\n    takerProtocolFee: new bignumber_js_1.default(order.taker_protocol_fee),\n    makerReferrerFee: new bignumber_js_1.default(order.maker_referrer_fee || 0),\n    waitingForBestCounterOrder: order.fee_recipient.address == constants_1.NULL_ADDRESS,\n    feeMethod: order.fee_method,\n    feeRecipientAccount: order.fee_recipient,\n    feeRecipient: order.fee_recipient.address,\n    side: order.side,\n    saleKind: order.sale_kind,\n    target: order.target,\n    howToCall: order.how_to_call,\n    calldata: order.calldata,\n    replacementPattern: order.replacement_pattern,\n    staticTarget: order.static_target,\n    staticExtradata: order.static_extradata,\n    paymentToken: order.payment_token,\n    basePrice: new bignumber_js_1.default(order.base_price),\n    extra: new bignumber_js_1.default(order.extra),\n    currentBounty: new bignumber_js_1.default(order.current_bounty || 0),\n    currentPrice: new bignumber_js_1.default(order.current_price || 0),\n    createdTime: new bignumber_js_1.default(Math.round(createdDate.getTime() / 1000)),\n    listingTime: new bignumber_js_1.default(order.listing_time),\n    expirationTime: new bignumber_js_1.default(order.expiration_time),\n    salt: new bignumber_js_1.default(order.salt),\n    v: parseInt(order.v),\n    r: order.r,\n    s: order.s,\n    paymentTokenContract: order.payment_token_contract ? (0, exports.tokenFromJSON)(order.payment_token_contract) : undefined,\n    asset: order.asset ? (0, exports.assetFromJSON)(order.asset) : undefined,\n    assetBundle: order.asset_bundle ? (0, exports.assetBundleFromJSON)(order.asset_bundle) : undefined\n  }; // Use client-side price calc, to account for buyer fee (not added by server) and latency\n\n  fromJSON.currentPrice = estimateCurrentPrice(fromJSON);\n  return fromJSON;\n};\n\nexports.orderFromJSON = orderFromJSON;\n/**\n * Convert an order to JSON, hashing it as well if necessary\n * @param order order (hashed or unhashed)\n */\n\nvar orderToJSON = function (order) {\n  var asJSON = {\n    exchange: order.exchange.toLowerCase(),\n    maker: order.maker.toLowerCase(),\n    taker: order.taker.toLowerCase(),\n    makerRelayerFee: order.makerRelayerFee.toString(),\n    takerRelayerFee: order.takerRelayerFee.toString(),\n    makerProtocolFee: order.makerProtocolFee.toString(),\n    takerProtocolFee: order.takerProtocolFee.toString(),\n    makerReferrerFee: order.makerReferrerFee.toString(),\n    feeMethod: order.feeMethod,\n    feeRecipient: order.feeRecipient.toLowerCase(),\n    side: order.side,\n    saleKind: order.saleKind,\n    target: order.target.toLowerCase(),\n    howToCall: order.howToCall,\n    calldata: order.calldata,\n    replacementPattern: order.replacementPattern,\n    staticTarget: order.staticTarget.toLowerCase(),\n    staticExtradata: order.staticExtradata,\n    paymentToken: order.paymentToken.toLowerCase(),\n    quantity: order.quantity.toString(),\n    basePrice: order.basePrice.toString(),\n    englishAuctionReservePrice: order.englishAuctionReservePrice ? order.englishAuctionReservePrice.toString() : undefined,\n    extra: order.extra.toString(),\n    createdTime: order.createdTime ? order.createdTime.toString() : undefined,\n    listingTime: order.listingTime.toString(),\n    expirationTime: order.expirationTime.toString(),\n    salt: order.salt.toString(),\n    metadata: order.metadata,\n    v: order.v,\n    r: order.r,\n    s: order.s,\n    hash: order.hash\n  };\n  return asJSON;\n};\n\nexports.orderToJSON = orderToJSON;\n/**\n * Sign messages using web3 personal signatures\n * @param web3 Web3 instance\n * @param message message to sign\n * @param signerAddress web3 address signing the message\n * @returns A signature if provider can sign, otherwise null\n */\n\nfunction personalSignAsync(web3, message, signerAddress) {\n  return __awaiter(this, void 0, void 0, function () {\n    var signature, error;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , promisify(function (c) {\n            return web3.currentProvider.sendAsync({\n              method: \"personal_sign\",\n              params: [message, signerAddress],\n              from: signerAddress,\n              id: new Date().getTime() // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n            }, c);\n          })];\n\n        case 1:\n          signature = _a.sent();\n          error = signature.error;\n\n          if (error) {\n            throw new Error(error);\n          }\n\n          return [2\n          /*return*/\n          , parseSignatureHex(signature.result)];\n      }\n    });\n  });\n}\n\nexports.personalSignAsync = personalSignAsync;\n/**\n * Checks whether a given address contains any code\n * @param web3 Web3 instance\n * @param address input address\n */\n\nfunction isContractAddress(web3, address) {\n  return __awaiter(this, void 0, void 0, function () {\n    var code;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , promisify(function (c) {\n            return web3.eth.getCode(address, c);\n          })];\n\n        case 1:\n          code = _a.sent();\n          return [2\n          /*return*/\n          , code !== \"0x\"];\n      }\n    });\n  });\n}\n\nexports.isContractAddress = isContractAddress;\n/**\n * Special fixes for making BigNumbers using web3 results\n * @param arg An arg or the result of a web3 call to turn into a BigNumber\n */\n\nfunction makeBigNumber(arg) {\n  // Zero sometimes returned as 0x from contracts\n  if (arg === \"0x\") {\n    arg = 0;\n  } // fix \"new BigNumber() number type has more than 15 significant digits\"\n\n\n  arg = arg.toString();\n  return new bignumber_js_1.default(arg);\n}\n\nexports.makeBigNumber = makeBigNumber;\n/**\n * Send a transaction to the blockchain and optionally confirm it\n * @param web3 Web3 instance\n * @param param0 __namedParameters\n * @param from address sending transaction\n * @param to destination contract address\n * @param data data to send to contract\n * @param gasPrice gas price to use. If unspecified, uses web3 default (mean gas price)\n * @param value value in ETH to send with data. Defaults to 0\n * @param onError callback when user denies transaction\n */\n\nfunction sendRawTransaction(web3, _a, onError) {\n  var from = _a.from,\n      to = _a.to,\n      data = _a.data,\n      gasPrice = _a.gasPrice,\n      _b = _a.value,\n      value = _b === void 0 ? 0 : _b,\n      gas = _a.gas;\n  return __awaiter(this, void 0, void 0, function () {\n    var txHashRes, error_2;\n    return __generator(this, function (_c) {\n      switch (_c.label) {\n        case 0:\n          if (!(gas == null)) return [3\n          /*break*/\n          , 2];\n          return [4\n          /*yield*/\n          , estimateGas(web3, {\n            from: from,\n            to: to,\n            data: data,\n            value: value\n          })];\n\n        case 1:\n          // This gas cannot be increased due to an ethjs error\n          gas = _c.sent();\n          _c.label = 2;\n\n        case 2:\n          _c.trys.push([2, 4,, 5]);\n\n          return [4\n          /*yield*/\n          , promisify(function (c) {\n            return web3.eth.sendTransaction({\n              from: from,\n              to: to,\n              value: value,\n              data: data,\n              gas: gas,\n              gasPrice: gasPrice\n            }, c);\n          })];\n\n        case 3:\n          txHashRes = _c.sent();\n          return [2\n          /*return*/\n          , txHashRes.toString()];\n\n        case 4:\n          error_2 = _c.sent();\n          onError(error_2);\n          throw error_2;\n\n        case 5:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nexports.sendRawTransaction = sendRawTransaction;\n/**\n * Call a method on a contract, sending arbitrary data and\n * handling Parity errors. Returns '0x' if error.\n * @param web3 Web3 instance\n * @param param0 __namedParameters\n * @param from address sending call\n * @param to destination contract address\n * @param data data to send to contract\n * @param onError callback when user denies transaction\n */\n\nfunction rawCall(web3, _a, onError) {\n  var from = _a.from,\n      to = _a.to,\n      data = _a.data;\n  return __awaiter(this, void 0, void 0, function () {\n    var result, error_3;\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          _b.trys.push([0, 2,, 3]);\n\n          return [4\n          /*yield*/\n          , promisify(function (c) {\n            return web3.eth.call({\n              from: from,\n              to: to,\n              data: data\n            }, c);\n          })];\n\n        case 1:\n          result = _b.sent();\n          return [2\n          /*return*/\n          , result];\n\n        case 2:\n          error_3 = _b.sent(); // Probably method not found, and web3 is a Parity node\n\n          if (onError) {\n            onError(error_3);\n          } // Backwards compatibility with Geth nodes\n\n\n          return [2\n          /*return*/\n          , \"0x\"];\n\n        case 3:\n          return [2\n          /*return*/\n          ];\n      }\n    });\n  });\n}\n\nexports.rawCall = rawCall;\n/**\n * Estimate Gas usage for a transaction\n * @param web3 Web3 instance\n * @param from address sending transaction\n * @param to destination contract address\n * @param data data to send to contract\n * @param value value in ETH to send with data\n */\n\nfunction estimateGas(web3, _a) {\n  var from = _a.from,\n      to = _a.to,\n      data = _a.data,\n      _b = _a.value,\n      value = _b === void 0 ? 0 : _b;\n  return __awaiter(this, void 0, void 0, function () {\n    var amount;\n    return __generator(this, function (_c) {\n      switch (_c.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , promisify(function (c) {\n            return web3.eth.estimateGas({\n              from: from,\n              to: to,\n              value: value,\n              data: data\n            }, c);\n          })];\n\n        case 1:\n          amount = _c.sent();\n          return [2\n          /*return*/\n          , amount];\n      }\n    });\n  });\n}\n\nexports.estimateGas = estimateGas;\n/**\n * Get mean gas price for sending a txn, in wei\n * @param web3 Web3 instance\n */\n\nfunction getCurrentGasPrice(web3) {\n  return __awaiter(this, void 0, void 0, function () {\n    var meanGas;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , promisify(function (c) {\n            return web3.eth.getGasPrice(c);\n          })];\n\n        case 1:\n          meanGas = _a.sent();\n          return [2\n          /*return*/\n          , meanGas];\n      }\n    });\n  });\n}\n\nexports.getCurrentGasPrice = getCurrentGasPrice;\n/**\n * Get current transfer fees for an asset\n * @param web3 Web3 instance\n * @param asset The asset to check for transfer fees\n */\n\nfunction getTransferFeeSettings(web3, _a) {\n  var asset = _a.asset,\n      accountAddress = _a.accountAddress;\n  return __awaiter(this, void 0, void 0, function () {\n    var transferFee, transferFeeTokenAddress, feeContract_1, params;\n    return __generator(this, function (_b) {\n      switch (_b.label) {\n        case 0:\n          if (!(asset.tokenAddress.toLowerCase() == constants_1.ENJIN_ADDRESS.toLowerCase())) return [3\n          /*break*/\n          , 2];\n          feeContract_1 = web3.eth.contract(contracts_1.ERC1155).at(asset.tokenAddress);\n          return [4\n          /*yield*/\n          , promisifyCall(function (c) {\n            return feeContract_1.transferSettings(asset.tokenId, {\n              from: accountAddress\n            }, c);\n          })];\n\n        case 1:\n          params = _b.sent();\n\n          if (params) {\n            transferFee = makeBigNumber(params[3]);\n\n            if (params[2] == 0) {\n              transferFeeTokenAddress = constants_1.ENJIN_COIN_ADDRESS;\n            }\n          }\n\n          _b.label = 2;\n\n        case 2:\n          return [2\n          /*return*/\n          , {\n            transferFee: transferFee,\n            transferFeeTokenAddress: transferFeeTokenAddress\n          }];\n      }\n    });\n  });\n}\n\nexports.getTransferFeeSettings = getTransferFeeSettings; // sourced from 0x.js:\n// https://github.com/ProjectWyvern/wyvern-js/blob/39999cb93ce5d80ea90b4382182d1bd4339a9c6c/src/utils/signature_utils.ts\n\nfunction parseSignatureHex(signature) {\n  // HACK: There is no consensus on whether the signatureHex string should be formatted as\n  // v + r + s OR r + s + v, and different clients (even different versions of the same client)\n  // return the signature params in different orders. In order to support all client implementations,\n  // we parse the signature in both ways, and evaluate if either one is a valid signature.\n  var validVParamValues = [27, 28];\n\n  var ecSignatureRSV = _parseSignatureHexAsRSV(signature);\n\n  if (_.includes(validVParamValues, ecSignatureRSV.v)) {\n    return ecSignatureRSV;\n  } // For older clients\n\n\n  var ecSignatureVRS = _parseSignatureHexAsVRS(signature);\n\n  if (_.includes(validVParamValues, ecSignatureVRS.v)) {\n    return ecSignatureVRS;\n  }\n\n  throw new Error(\"Invalid signature\");\n\n  function _parseSignatureHexAsVRS(signatureHex) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    var signatureBuffer = ethUtil.toBuffer(signatureHex);\n    var v = signatureBuffer[0];\n\n    if (v < 27) {\n      v += 27;\n    }\n\n    var r = signatureBuffer.slice(1, 33);\n    var s = signatureBuffer.slice(33, 65);\n    var ecSignature = {\n      v: v,\n      r: ethUtil.bufferToHex(r),\n      s: ethUtil.bufferToHex(s)\n    };\n    return ecSignature;\n  }\n\n  function _parseSignatureHexAsRSV(signatureHex) {\n    var _a = ethUtil.fromRpcSig(signatureHex),\n        v = _a.v,\n        r = _a.r,\n        s = _a.s;\n\n    var ecSignature = {\n      v: v,\n      r: ethUtil.bufferToHex(r),\n      s: ethUtil.bufferToHex(s)\n    };\n    return ecSignature;\n  }\n}\n/**\n * Estimates the price of an order\n * @param order The order to estimate price on\n * @param secondsToBacktrack The number of seconds to subtract on current time,\n *  to fix race conditions\n * @param shouldRoundUp Whether to round up fractional wei\n */\n\n\nfunction estimateCurrentPrice(order, secondsToBacktrack, shouldRoundUp) {\n  if (secondsToBacktrack === void 0) {\n    secondsToBacktrack = 30;\n  }\n\n  if (shouldRoundUp === void 0) {\n    shouldRoundUp = true;\n  }\n\n  var basePrice = order.basePrice,\n      listingTime = order.listingTime,\n      expirationTime = order.expirationTime,\n      extra = order.extra;\n  var side = order.side,\n      takerRelayerFee = order.takerRelayerFee,\n      saleKind = order.saleKind;\n  var now = new bignumber_js_1.default(Math.round(Date.now() / 1000)).minus(secondsToBacktrack);\n  basePrice = new bignumber_js_1.default(basePrice);\n  listingTime = new bignumber_js_1.default(listingTime);\n  expirationTime = new bignumber_js_1.default(expirationTime);\n  extra = new bignumber_js_1.default(extra);\n  var exactPrice = basePrice;\n\n  if (saleKind === types_2.SaleKind.FixedPrice) {// Do nothing, price is correct\n  } else if (saleKind === types_2.SaleKind.DutchAuction) {\n    var diff = extra.times(now.minus(listingTime)).dividedBy(expirationTime.minus(listingTime));\n    exactPrice = side == types_2.OrderSide.Sell ?\n    /* Sell-side - start price: basePrice. End price: basePrice - extra. */\n    basePrice.minus(diff) :\n    /* Buy-side - start price: basePrice. End price: basePrice + extra. */\n    basePrice.plus(diff);\n  } // Add taker fee only for buyers\n\n\n  if (side === types_2.OrderSide.Sell && !order.waitingForBestCounterOrder) {\n    // Buyer fee increases sale price\n    exactPrice = exactPrice.times(+takerRelayerFee / constants_1.INVERSE_BASIS_POINT + 1);\n  }\n\n  return shouldRoundUp ? exactPrice.ceil() : exactPrice;\n}\n\nexports.estimateCurrentPrice = estimateCurrentPrice;\n/**\n * Get the Wyvern representation of a fungible asset\n * @param schema The WyvernSchema needed to access this asset\n * @param asset The asset to trade\n * @param quantity The number of items to trade\n */\n\nfunction getWyvernAsset(schema, asset, quantity) {\n  if (quantity === void 0) {\n    quantity = new bignumber_js_1.default(1);\n  }\n\n  var tokenId = asset.tokenId != null ? asset.tokenId.toString() : undefined;\n  return schema.assetFromFields({\n    ID: tokenId,\n    Quantity: quantity.toString(),\n    Address: asset.tokenAddress.toLowerCase(),\n    Name: asset.name\n  });\n}\n\nexports.getWyvernAsset = getWyvernAsset;\n/**\n * Get the Wyvern representation of a group of assets\n * Sort order is enforced here. Throws if there's a duplicate.\n * @param assets Assets to bundle\n * @param schemas The WyvernSchemas needed to access each asset, respectively\n * @param quantities The quantity of each asset to bundle, respectively\n */\n\nfunction getWyvernBundle(assets, schemas, quantities) {\n  if (assets.length != quantities.length) {\n    throw new Error(\"Bundle must have a quantity for every asset\");\n  }\n\n  if (assets.length != schemas.length) {\n    throw new Error(\"Bundle must have a schema for every asset\");\n  }\n\n  var wyAssets = assets.map(function (asset, i) {\n    return getWyvernAsset(schemas[i], asset, quantities[i]);\n  });\n  var sorters = [function (assetAndSchema) {\n    return assetAndSchema.asset.address;\n  }, function (assetAndSchema) {\n    return assetAndSchema.asset.id || 0;\n  }];\n  var wyAssetsAndSchemas = wyAssets.map(function (asset, i) {\n    return {\n      asset: asset,\n      schema: schemas[i].name\n    };\n  });\n\n  var uniqueAssets = _.uniqBy(wyAssetsAndSchemas, function (group) {\n    return \"\".concat(sorters[0](group), \"-\").concat(sorters[1](group));\n  });\n\n  if (uniqueAssets.length != wyAssetsAndSchemas.length) {\n    throw new Error(\"Bundle can't contain duplicate assets\");\n  }\n\n  var sortedWyAssetsAndSchemas = _.sortBy(wyAssetsAndSchemas, sorters);\n\n  return {\n    assets: sortedWyAssetsAndSchemas.map(function (group) {\n      return group.asset;\n    }),\n    schemas: sortedWyAssetsAndSchemas.map(function (group) {\n      return group.schema;\n    })\n  };\n}\n\nexports.getWyvernBundle = getWyvernBundle;\n/**\n * Get the non-prefixed hash for the order\n * (Fixes a Wyvern typescript issue and casing issue)\n * @param order order to hash\n */\n\nfunction getOrderHash(order) {\n  var orderWithStringTypes = __assign(__assign({}, order), {\n    maker: order.maker.toLowerCase(),\n    taker: order.taker.toLowerCase(),\n    feeRecipient: order.feeRecipient.toLowerCase(),\n    side: order.side.toString(),\n    saleKind: order.saleKind.toString(),\n    howToCall: order.howToCall.toString(),\n    feeMethod: order.feeMethod.toString()\n  }); // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\n  return wyvern_js_1.WyvernProtocol.getOrderHashHex(orderWithStringTypes);\n}\n\nexports.getOrderHash = getOrderHash;\n/**\n * Assign an order and a new matching order to their buy/sell sides\n * @param order Original order\n * @param matchingOrder The result of _makeMatchingOrder\n */\n\nfunction assignOrdersToSides(order, matchingOrder) {\n  var isSellOrder = order.side == types_2.OrderSide.Sell;\n  var buy;\n  var sell;\n\n  if (!isSellOrder) {\n    buy = order;\n    sell = __assign(__assign({}, matchingOrder), {\n      v: buy.v,\n      r: buy.r,\n      s: buy.s\n    });\n  } else {\n    sell = order;\n    buy = __assign(__assign({}, matchingOrder), {\n      v: sell.v,\n      r: sell.r,\n      s: sell.s\n    });\n  }\n\n  return {\n    buy: buy,\n    sell: sell\n  };\n}\n\nexports.assignOrdersToSides = assignOrdersToSides;\n/**\n * Delay using setTimeout\n * @param ms milliseconds to wait\n */\n\nfunction delay(ms) {\n  return __awaiter(this, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      return [2\n      /*return*/\n      , new Promise(function (res) {\n        return setTimeout(res, ms);\n      })];\n    });\n  });\n}\n\nexports.delay = delay;\n/**\n * Validates that an address exists, isn't null, and is properly\n * formatted for Wyvern and OpenSea\n * @param address input address\n */\n\nfunction validateAndFormatWalletAddress(web3, address) {\n  if (!address) {\n    throw new Error(\"No wallet address found\");\n  }\n\n  if (!web3.isAddress(address)) {\n    throw new Error(\"Invalid wallet address\");\n  }\n\n  if (address == constants_1.NULL_ADDRESS) {\n    throw new Error(\"Wallet cannot be the null address\");\n  }\n\n  return address.toLowerCase();\n}\n\nexports.validateAndFormatWalletAddress = validateAndFormatWalletAddress;\n/**\n * Notify developer when a pattern will be deprecated\n * @param msg message to log to console\n */\n\nfunction onDeprecated(msg) {\n  console.warn(\"DEPRECATION NOTICE: \".concat(msg));\n}\n\nexports.onDeprecated = onDeprecated;\n/**\n * Get special-case approval addresses for an erc721 contract\n * @param erc721Contract contract to check\n */\n\nfunction getNonCompliantApprovalAddress(erc721Contract, tokenId, _accountAddress) {\n  return __awaiter(this, void 0, void 0, function () {\n    var results;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          return [4\n          /*yield*/\n          , Promise.all([// CRYPTOKITTIES check\n          promisifyCall(function (c) {\n            return erc721Contract.kittyIndexToApproved.call(tokenId, c);\n          }), // Etherbots check\n          promisifyCall(function (c) {\n            return erc721Contract.partIndexToApproved.call(tokenId, c);\n          })])];\n\n        case 1:\n          results = _a.sent();\n          return [2\n          /*return*/\n          , _.compact(results)[0]];\n      }\n    });\n  });\n}\n\nexports.getNonCompliantApprovalAddress = getNonCompliantApprovalAddress;","map":{"version":3,"sources":["../../src/utils/utils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getNonCompliantApprovalAddress = exports.onDeprecated = exports.validateAndFormatWalletAddress = exports.delay = exports.assignOrdersToSides = exports.getOrderHash = exports.getWyvernBundle = exports.getWyvernAsset = exports.estimateCurrentPrice = exports.getTransferFeeSettings = exports.getCurrentGasPrice = exports.estimateGas = exports.rawCall = exports.sendRawTransaction = exports.makeBigNumber = exports.isContractAddress = exports.personalSignAsync = exports.orderToJSON = exports.orderFromJSON = exports.tokenFromJSON = exports.collectionFromJSON = exports.assetContractFromJSON = exports.assetBundleFromJSON = exports.userFromJSON = exports.accountFromJSON = exports.transactionFromJSON = exports.assetEventFromJSON = exports.assetFromJSON = exports.confirmTransaction = exports.promisifyCall = exports.annotateERC20TransferABI = exports.annotateERC721TransferABI = exports.WyvernProtocol = void 0;\nvar bignumber_js_1 = __importDefault(require(\"bignumber.js\"));\nvar ethUtil = __importStar(require(\"ethereumjs-util\"));\nvar _ = __importStar(require(\"lodash\"));\nvar Web3 = __importStar(require(\"web3\"));\nvar wyvern_js_1 = require(\"wyvern-js\");\nObject.defineProperty(exports, \"WyvernProtocol\", { enumerable: true, get: function () { return wyvern_js_1.WyvernProtocol; } });\nvar types_1 = require(\"wyvern-schemas/dist/types\");\nvar constants_1 = require(\"../constants\");\nvar contracts_1 = require(\"../contracts\");\nvar types_2 = require(\"../types\");\nvar annotateERC721TransferABI = function (asset) { return ({\n    constant: false,\n    inputs: [\n        {\n            name: \"_to\",\n            type: \"address\",\n            kind: types_1.FunctionInputKind.Replaceable,\n        },\n        {\n            name: \"_tokenId\",\n            type: \"uint256\",\n            kind: types_1.FunctionInputKind.Asset,\n            value: asset.id,\n        },\n    ],\n    target: asset.address,\n    name: \"transfer\",\n    outputs: [],\n    payable: false,\n    stateMutability: types_1.StateMutability.Nonpayable,\n    type: Web3.AbiType.Function,\n}); };\nexports.annotateERC721TransferABI = annotateERC721TransferABI;\nvar annotateERC20TransferABI = function (asset) { return ({\n    constant: false,\n    inputs: [\n        {\n            name: \"_to\",\n            type: \"address\",\n            kind: types_1.FunctionInputKind.Replaceable,\n        },\n        {\n            name: \"_amount\",\n            type: \"uint256\",\n            kind: types_1.FunctionInputKind.Count,\n            value: asset.quantity,\n        },\n    ],\n    target: asset.address,\n    name: \"transfer\",\n    outputs: [\n        {\n            name: \"success\",\n            type: \"bool\",\n            kind: types_1.FunctionOutputKind.Other,\n        },\n    ],\n    payable: false,\n    stateMutability: types_1.StateMutability.Nonpayable,\n    type: Web3.AbiType.Function,\n}); };\nexports.annotateERC20TransferABI = annotateERC20TransferABI;\n// OTHER\nvar txCallbacks = {};\n/**\n * Promisify a callback-syntax web3 function\n * @param inner callback function that accepts a Web3 callback function and passes\n * it to the Web3 function\n */\nfunction promisify(inner) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n                    return inner(function (err, res) {\n                        if (err) {\n                            reject(err);\n                        }\n                        resolve(res);\n                    });\n                })];\n        });\n    });\n}\n/**\n * Promisify a call a method on a contract,\n * handling Parity errors. Returns '0x' if error.\n * Note that if T is not \"string\", this may return a falsey\n * value when the contract doesn't support the method (e.g. `isApprovedForAll`).\n * @param callback An anonymous function that takes a web3 callback\n * and returns a Web3 Contract's call result, e.g. `c => erc721.ownerOf(3, c)`\n * @param onError callback when user denies transaction\n */\nfunction promisifyCall(callback, onError) {\n    return __awaiter(this, void 0, void 0, function () {\n        var result, error_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    _a.trys.push([0, 2, , 3]);\n                    return [4 /*yield*/, promisify(callback)];\n                case 1:\n                    result = _a.sent();\n                    if (typeof result === \"string\" && result == \"0x\") {\n                        // Geth compatibility\n                        return [2 /*return*/, undefined];\n                    }\n                    return [2 /*return*/, result];\n                case 2:\n                    error_1 = _a.sent();\n                    // Probably method not found, and web3 is a Parity node\n                    if (onError) {\n                        onError(error_1);\n                    }\n                    else {\n                        console.error(error_1);\n                    }\n                    return [2 /*return*/, undefined];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.promisifyCall = promisifyCall;\nvar track = function (web3, txHash, onFinalized) {\n    if (txCallbacks[txHash]) {\n        txCallbacks[txHash].push(onFinalized);\n    }\n    else {\n        txCallbacks[txHash] = [onFinalized];\n        var poll_1 = function () { return __awaiter(void 0, void 0, void 0, function () {\n            var tx, receipt, status_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0: return [4 /*yield*/, promisify(function (c) {\n                            return web3.eth.getTransaction(txHash, c);\n                        })];\n                    case 1:\n                        tx = _a.sent();\n                        if (!(tx && tx.blockHash && tx.blockHash !== constants_1.NULL_BLOCK_HASH)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, promisify(function (c) {\n                                return web3.eth.getTransactionReceipt(txHash, c);\n                            })];\n                    case 2:\n                        receipt = _a.sent();\n                        if (!receipt) {\n                            // Hack: assume success if no receipt\n                            console.warn(\"No receipt found for \", txHash);\n                        }\n                        status_1 = receipt\n                            ? parseInt((receipt.status || \"0\").toString()) == 1\n                            : true;\n                        txCallbacks[txHash].map(function (f) { return f(status_1); });\n                        delete txCallbacks[txHash];\n                        return [3 /*break*/, 4];\n                    case 3:\n                        setTimeout(poll_1, 1000);\n                        _a.label = 4;\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        poll_1().catch();\n    }\n};\nvar confirmTransaction = function (web3, txHash) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        return [2 /*return*/, new Promise(function (resolve, reject) {\n                track(web3, txHash, function (didSucceed) {\n                    if (didSucceed) {\n                        resolve(\"Transaction complete!\");\n                    }\n                    else {\n                        reject(new Error(\"Transaction failed :( You might have already completed this action. See more on the mainnet at etherscan.io/tx/\".concat(txHash)));\n                    }\n                });\n            })];\n    });\n}); };\nexports.confirmTransaction = confirmTransaction;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar assetFromJSON = function (asset) {\n    var isAnimated = asset.image_url && asset.image_url.endsWith(\".gif\");\n    var isSvg = asset.image_url && asset.image_url.endsWith(\".svg\");\n    var fromJSON = {\n        tokenId: asset.token_id.toString(),\n        tokenAddress: asset.asset_contract.address,\n        name: asset.name,\n        description: asset.description,\n        owner: asset.owner,\n        assetContract: (0, exports.assetContractFromJSON)(asset.asset_contract),\n        collection: (0, exports.collectionFromJSON)(asset.collection),\n        orders: asset.orders ? asset.orders.map(exports.orderFromJSON) : null,\n        sellOrders: asset.sell_orders ? asset.sell_orders.map(exports.orderFromJSON) : null,\n        buyOrders: asset.buy_orders ? asset.buy_orders.map(exports.orderFromJSON) : null,\n        isPresale: asset.is_presale,\n        // Don't use previews if it's a special image\n        imageUrl: isAnimated || isSvg\n            ? asset.image_url\n            : asset.image_preview_url || asset.image_url,\n        imagePreviewUrl: asset.image_preview_url,\n        imageUrlOriginal: asset.image_original_url,\n        imageUrlThumbnail: asset.image_thumbnail_url,\n        externalLink: asset.external_link,\n        openseaLink: asset.permalink,\n        traits: asset.traits,\n        numSales: asset.num_sales,\n        lastSale: asset.last_sale ? (0, exports.assetEventFromJSON)(asset.last_sale) : null,\n        backgroundColor: asset.background_color\n            ? \"#\".concat(asset.background_color)\n            : null,\n        transferFee: asset.transfer_fee ? makeBigNumber(asset.transfer_fee) : null,\n        transferFeePaymentToken: asset.transfer_fee_payment_token\n            ? (0, exports.tokenFromJSON)(asset.transfer_fee_payment_token)\n            : null,\n    };\n    // If orders were included, put them in sell/buy order groups\n    if (fromJSON.orders && !fromJSON.sellOrders) {\n        fromJSON.sellOrders = fromJSON.orders.filter(function (o) { return o.side == types_2.OrderSide.Sell; });\n    }\n    if (fromJSON.orders && !fromJSON.buyOrders) {\n        fromJSON.buyOrders = fromJSON.orders.filter(function (o) { return o.side == types_2.OrderSide.Buy; });\n    }\n    return fromJSON;\n};\nexports.assetFromJSON = assetFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar assetEventFromJSON = function (assetEvent) {\n    return {\n        eventType: assetEvent.event_type,\n        eventTimestamp: assetEvent.event_timestamp,\n        auctionType: assetEvent.auction_type,\n        totalPrice: assetEvent.total_price,\n        transaction: assetEvent.transaction\n            ? (0, exports.transactionFromJSON)(assetEvent.transaction)\n            : null,\n        paymentToken: assetEvent.payment_token\n            ? (0, exports.tokenFromJSON)(assetEvent.payment_token)\n            : null,\n    };\n};\nexports.assetEventFromJSON = assetEventFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar transactionFromJSON = function (transaction) {\n    return {\n        fromAccount: (0, exports.accountFromJSON)(transaction.from_account),\n        toAccount: (0, exports.accountFromJSON)(transaction.to_account),\n        createdDate: new Date(\"\".concat(transaction.created_date, \"Z\")),\n        modifiedDate: new Date(\"\".concat(transaction.modified_date, \"Z\")),\n        transactionHash: transaction.transaction_hash,\n        transactionIndex: transaction.transaction_index,\n        blockNumber: transaction.block_number,\n        blockHash: transaction.block_hash,\n        timestamp: new Date(\"\".concat(transaction.timestamp, \"Z\")),\n    };\n};\nexports.transactionFromJSON = transactionFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar accountFromJSON = function (account) {\n    return {\n        address: account.address,\n        config: account.config,\n        profileImgUrl: account.profile_img_url,\n        user: account.user ? (0, exports.userFromJSON)(account.user) : null,\n    };\n};\nexports.accountFromJSON = accountFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar userFromJSON = function (user) {\n    return {\n        username: user.username,\n    };\n};\nexports.userFromJSON = userFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar assetBundleFromJSON = function (asset_bundle) {\n    var fromJSON = {\n        maker: asset_bundle.maker,\n        assets: asset_bundle.assets.map(exports.assetFromJSON),\n        assetContract: asset_bundle.asset_contract\n            ? (0, exports.assetContractFromJSON)(asset_bundle.asset_contract)\n            : undefined,\n        name: asset_bundle.name,\n        slug: asset_bundle.slug,\n        description: asset_bundle.description,\n        externalLink: asset_bundle.external_link,\n        permalink: asset_bundle.permalink,\n        sellOrders: asset_bundle.sell_orders\n            ? asset_bundle.sell_orders.map(exports.orderFromJSON)\n            : null,\n    };\n    return fromJSON;\n};\nexports.assetBundleFromJSON = assetBundleFromJSON;\nvar assetContractFromJSON = function (\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nasset_contract) {\n    return {\n        name: asset_contract.name,\n        description: asset_contract.description,\n        type: asset_contract.asset_contract_type,\n        schemaName: asset_contract.schema_name,\n        address: asset_contract.address,\n        tokenSymbol: asset_contract.symbol,\n        buyerFeeBasisPoints: +asset_contract.buyer_fee_basis_points,\n        sellerFeeBasisPoints: +asset_contract.seller_fee_basis_points,\n        openseaBuyerFeeBasisPoints: +asset_contract.opensea_buyer_fee_basis_points,\n        openseaSellerFeeBasisPoints: +asset_contract.opensea_seller_fee_basis_points,\n        devBuyerFeeBasisPoints: +asset_contract.dev_buyer_fee_basis_points,\n        devSellerFeeBasisPoints: +asset_contract.dev_seller_fee_basis_points,\n        imageUrl: asset_contract.image_url,\n        externalLink: asset_contract.external_link,\n        wikiLink: asset_contract.wiki_link,\n    };\n};\nexports.assetContractFromJSON = assetContractFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar collectionFromJSON = function (collection) {\n    var createdDate = new Date(\"\".concat(collection.created_date, \"Z\"));\n    return {\n        createdDate: createdDate,\n        name: collection.name,\n        description: collection.description,\n        slug: collection.slug,\n        editors: collection.editors,\n        hidden: collection.hidden,\n        featured: collection.featured,\n        featuredImageUrl: collection.featured_image_url,\n        displayData: collection.display_data,\n        paymentTokens: (collection.payment_tokens || []).map(exports.tokenFromJSON),\n        openseaBuyerFeeBasisPoints: +collection.opensea_buyer_fee_basis_points,\n        openseaSellerFeeBasisPoints: +collection.opensea_seller_fee_basis_points,\n        devBuyerFeeBasisPoints: +collection.dev_buyer_fee_basis_points,\n        devSellerFeeBasisPoints: +collection.dev_seller_fee_basis_points,\n        payoutAddress: collection.payout_address,\n        imageUrl: collection.image_url,\n        largeImageUrl: collection.large_image_url,\n        stats: collection.stats,\n        traitStats: collection.traits,\n        externalLink: collection.external_url,\n        wikiLink: collection.wiki_url,\n    };\n};\nexports.collectionFromJSON = collectionFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar tokenFromJSON = function (token) {\n    var fromJSON = {\n        name: token.name,\n        symbol: token.symbol,\n        decimals: token.decimals,\n        address: token.address,\n        imageUrl: token.image_url,\n        ethPrice: token.eth_price,\n        usdPrice: token.usd_price,\n    };\n    return fromJSON;\n};\nexports.tokenFromJSON = tokenFromJSON;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nvar orderFromJSON = function (order) {\n    var createdDate = new Date(\"\".concat(order.created_date, \"Z\"));\n    var fromJSON = {\n        hash: order.order_hash || order.hash,\n        cancelledOrFinalized: order.cancelled || order.finalized,\n        markedInvalid: order.marked_invalid,\n        metadata: order.metadata,\n        quantity: new bignumber_js_1.default(order.quantity || 1),\n        exchange: order.exchange,\n        makerAccount: order.maker,\n        takerAccount: order.taker,\n        // Use string address to conform to Wyvern Order schema\n        maker: order.maker.address,\n        taker: order.taker.address,\n        makerRelayerFee: new bignumber_js_1.default(order.maker_relayer_fee),\n        takerRelayerFee: new bignumber_js_1.default(order.taker_relayer_fee),\n        makerProtocolFee: new bignumber_js_1.default(order.maker_protocol_fee),\n        takerProtocolFee: new bignumber_js_1.default(order.taker_protocol_fee),\n        makerReferrerFee: new bignumber_js_1.default(order.maker_referrer_fee || 0),\n        waitingForBestCounterOrder: order.fee_recipient.address == constants_1.NULL_ADDRESS,\n        feeMethod: order.fee_method,\n        feeRecipientAccount: order.fee_recipient,\n        feeRecipient: order.fee_recipient.address,\n        side: order.side,\n        saleKind: order.sale_kind,\n        target: order.target,\n        howToCall: order.how_to_call,\n        calldata: order.calldata,\n        replacementPattern: order.replacement_pattern,\n        staticTarget: order.static_target,\n        staticExtradata: order.static_extradata,\n        paymentToken: order.payment_token,\n        basePrice: new bignumber_js_1.default(order.base_price),\n        extra: new bignumber_js_1.default(order.extra),\n        currentBounty: new bignumber_js_1.default(order.current_bounty || 0),\n        currentPrice: new bignumber_js_1.default(order.current_price || 0),\n        createdTime: new bignumber_js_1.default(Math.round(createdDate.getTime() / 1000)),\n        listingTime: new bignumber_js_1.default(order.listing_time),\n        expirationTime: new bignumber_js_1.default(order.expiration_time),\n        salt: new bignumber_js_1.default(order.salt),\n        v: parseInt(order.v),\n        r: order.r,\n        s: order.s,\n        paymentTokenContract: order.payment_token_contract\n            ? (0, exports.tokenFromJSON)(order.payment_token_contract)\n            : undefined,\n        asset: order.asset ? (0, exports.assetFromJSON)(order.asset) : undefined,\n        assetBundle: order.asset_bundle\n            ? (0, exports.assetBundleFromJSON)(order.asset_bundle)\n            : undefined,\n    };\n    // Use client-side price calc, to account for buyer fee (not added by server) and latency\n    fromJSON.currentPrice = estimateCurrentPrice(fromJSON);\n    return fromJSON;\n};\nexports.orderFromJSON = orderFromJSON;\n/**\n * Convert an order to JSON, hashing it as well if necessary\n * @param order order (hashed or unhashed)\n */\nvar orderToJSON = function (order) {\n    var asJSON = {\n        exchange: order.exchange.toLowerCase(),\n        maker: order.maker.toLowerCase(),\n        taker: order.taker.toLowerCase(),\n        makerRelayerFee: order.makerRelayerFee.toString(),\n        takerRelayerFee: order.takerRelayerFee.toString(),\n        makerProtocolFee: order.makerProtocolFee.toString(),\n        takerProtocolFee: order.takerProtocolFee.toString(),\n        makerReferrerFee: order.makerReferrerFee.toString(),\n        feeMethod: order.feeMethod,\n        feeRecipient: order.feeRecipient.toLowerCase(),\n        side: order.side,\n        saleKind: order.saleKind,\n        target: order.target.toLowerCase(),\n        howToCall: order.howToCall,\n        calldata: order.calldata,\n        replacementPattern: order.replacementPattern,\n        staticTarget: order.staticTarget.toLowerCase(),\n        staticExtradata: order.staticExtradata,\n        paymentToken: order.paymentToken.toLowerCase(),\n        quantity: order.quantity.toString(),\n        basePrice: order.basePrice.toString(),\n        englishAuctionReservePrice: order.englishAuctionReservePrice\n            ? order.englishAuctionReservePrice.toString()\n            : undefined,\n        extra: order.extra.toString(),\n        createdTime: order.createdTime ? order.createdTime.toString() : undefined,\n        listingTime: order.listingTime.toString(),\n        expirationTime: order.expirationTime.toString(),\n        salt: order.salt.toString(),\n        metadata: order.metadata,\n        v: order.v,\n        r: order.r,\n        s: order.s,\n        hash: order.hash,\n    };\n    return asJSON;\n};\nexports.orderToJSON = orderToJSON;\n/**\n * Sign messages using web3 personal signatures\n * @param web3 Web3 instance\n * @param message message to sign\n * @param signerAddress web3 address signing the message\n * @returns A signature if provider can sign, otherwise null\n */\nfunction personalSignAsync(web3, message, signerAddress) {\n    return __awaiter(this, void 0, void 0, function () {\n        var signature, error;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, promisify(function (c) {\n                        return web3.currentProvider.sendAsync({\n                            method: \"personal_sign\",\n                            params: [message, signerAddress],\n                            from: signerAddress,\n                            id: new Date().getTime(),\n                            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        }, c);\n                    })];\n                case 1:\n                    signature = _a.sent();\n                    error = signature.error;\n                    if (error) {\n                        throw new Error(error);\n                    }\n                    return [2 /*return*/, parseSignatureHex(signature.result)];\n            }\n        });\n    });\n}\nexports.personalSignAsync = personalSignAsync;\n/**\n * Checks whether a given address contains any code\n * @param web3 Web3 instance\n * @param address input address\n */\nfunction isContractAddress(web3, address) {\n    return __awaiter(this, void 0, void 0, function () {\n        var code;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, promisify(function (c) { return web3.eth.getCode(address, c); })];\n                case 1:\n                    code = _a.sent();\n                    return [2 /*return*/, code !== \"0x\"];\n            }\n        });\n    });\n}\nexports.isContractAddress = isContractAddress;\n/**\n * Special fixes for making BigNumbers using web3 results\n * @param arg An arg or the result of a web3 call to turn into a BigNumber\n */\nfunction makeBigNumber(arg) {\n    // Zero sometimes returned as 0x from contracts\n    if (arg === \"0x\") {\n        arg = 0;\n    }\n    // fix \"new BigNumber() number type has more than 15 significant digits\"\n    arg = arg.toString();\n    return new bignumber_js_1.default(arg);\n}\nexports.makeBigNumber = makeBigNumber;\n/**\n * Send a transaction to the blockchain and optionally confirm it\n * @param web3 Web3 instance\n * @param param0 __namedParameters\n * @param from address sending transaction\n * @param to destination contract address\n * @param data data to send to contract\n * @param gasPrice gas price to use. If unspecified, uses web3 default (mean gas price)\n * @param value value in ETH to send with data. Defaults to 0\n * @param onError callback when user denies transaction\n */\nfunction sendRawTransaction(web3, _a, onError) {\n    var from = _a.from, to = _a.to, data = _a.data, gasPrice = _a.gasPrice, _b = _a.value, value = _b === void 0 ? 0 : _b, gas = _a.gas;\n    return __awaiter(this, void 0, void 0, function () {\n        var txHashRes, error_2;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    if (!(gas == null)) return [3 /*break*/, 2];\n                    return [4 /*yield*/, estimateGas(web3, { from: from, to: to, data: data, value: value })];\n                case 1:\n                    // This gas cannot be increased due to an ethjs error\n                    gas = _c.sent();\n                    _c.label = 2;\n                case 2:\n                    _c.trys.push([2, 4, , 5]);\n                    return [4 /*yield*/, promisify(function (c) {\n                            return web3.eth.sendTransaction({\n                                from: from,\n                                to: to,\n                                value: value,\n                                data: data,\n                                gas: gas,\n                                gasPrice: gasPrice,\n                            }, c);\n                        })];\n                case 3:\n                    txHashRes = _c.sent();\n                    return [2 /*return*/, txHashRes.toString()];\n                case 4:\n                    error_2 = _c.sent();\n                    onError(error_2);\n                    throw error_2;\n                case 5: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.sendRawTransaction = sendRawTransaction;\n/**\n * Call a method on a contract, sending arbitrary data and\n * handling Parity errors. Returns '0x' if error.\n * @param web3 Web3 instance\n * @param param0 __namedParameters\n * @param from address sending call\n * @param to destination contract address\n * @param data data to send to contract\n * @param onError callback when user denies transaction\n */\nfunction rawCall(web3, _a, onError) {\n    var from = _a.from, to = _a.to, data = _a.data;\n    return __awaiter(this, void 0, void 0, function () {\n        var result, error_3;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    _b.trys.push([0, 2, , 3]);\n                    return [4 /*yield*/, promisify(function (c) {\n                            return web3.eth.call({\n                                from: from,\n                                to: to,\n                                data: data,\n                            }, c);\n                        })];\n                case 1:\n                    result = _b.sent();\n                    return [2 /*return*/, result];\n                case 2:\n                    error_3 = _b.sent();\n                    // Probably method not found, and web3 is a Parity node\n                    if (onError) {\n                        onError(error_3);\n                    }\n                    // Backwards compatibility with Geth nodes\n                    return [2 /*return*/, \"0x\"];\n                case 3: return [2 /*return*/];\n            }\n        });\n    });\n}\nexports.rawCall = rawCall;\n/**\n * Estimate Gas usage for a transaction\n * @param web3 Web3 instance\n * @param from address sending transaction\n * @param to destination contract address\n * @param data data to send to contract\n * @param value value in ETH to send with data\n */\nfunction estimateGas(web3, _a) {\n    var from = _a.from, to = _a.to, data = _a.data, _b = _a.value, value = _b === void 0 ? 0 : _b;\n    return __awaiter(this, void 0, void 0, function () {\n        var amount;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0: return [4 /*yield*/, promisify(function (c) {\n                        return web3.eth.estimateGas({\n                            from: from,\n                            to: to,\n                            value: value,\n                            data: data,\n                        }, c);\n                    })];\n                case 1:\n                    amount = _c.sent();\n                    return [2 /*return*/, amount];\n            }\n        });\n    });\n}\nexports.estimateGas = estimateGas;\n/**\n * Get mean gas price for sending a txn, in wei\n * @param web3 Web3 instance\n */\nfunction getCurrentGasPrice(web3) {\n    return __awaiter(this, void 0, void 0, function () {\n        var meanGas;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, promisify(function (c) { return web3.eth.getGasPrice(c); })];\n                case 1:\n                    meanGas = _a.sent();\n                    return [2 /*return*/, meanGas];\n            }\n        });\n    });\n}\nexports.getCurrentGasPrice = getCurrentGasPrice;\n/**\n * Get current transfer fees for an asset\n * @param web3 Web3 instance\n * @param asset The asset to check for transfer fees\n */\nfunction getTransferFeeSettings(web3, _a) {\n    var asset = _a.asset, accountAddress = _a.accountAddress;\n    return __awaiter(this, void 0, void 0, function () {\n        var transferFee, transferFeeTokenAddress, feeContract_1, params;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    if (!(asset.tokenAddress.toLowerCase() == constants_1.ENJIN_ADDRESS.toLowerCase())) return [3 /*break*/, 2];\n                    feeContract_1 = web3.eth\n                        .contract(contracts_1.ERC1155)\n                        .at(asset.tokenAddress);\n                    return [4 /*yield*/, promisifyCall(function (c) {\n                            return feeContract_1.transferSettings(asset.tokenId, { from: accountAddress }, c);\n                        })];\n                case 1:\n                    params = _b.sent();\n                    if (params) {\n                        transferFee = makeBigNumber(params[3]);\n                        if (params[2] == 0) {\n                            transferFeeTokenAddress = constants_1.ENJIN_COIN_ADDRESS;\n                        }\n                    }\n                    _b.label = 2;\n                case 2: return [2 /*return*/, { transferFee: transferFee, transferFeeTokenAddress: transferFeeTokenAddress }];\n            }\n        });\n    });\n}\nexports.getTransferFeeSettings = getTransferFeeSettings;\n// sourced from 0x.js:\n// https://github.com/ProjectWyvern/wyvern-js/blob/39999cb93ce5d80ea90b4382182d1bd4339a9c6c/src/utils/signature_utils.ts\nfunction parseSignatureHex(signature) {\n    // HACK: There is no consensus on whether the signatureHex string should be formatted as\n    // v + r + s OR r + s + v, and different clients (even different versions of the same client)\n    // return the signature params in different orders. In order to support all client implementations,\n    // we parse the signature in both ways, and evaluate if either one is a valid signature.\n    var validVParamValues = [27, 28];\n    var ecSignatureRSV = _parseSignatureHexAsRSV(signature);\n    if (_.includes(validVParamValues, ecSignatureRSV.v)) {\n        return ecSignatureRSV;\n    }\n    // For older clients\n    var ecSignatureVRS = _parseSignatureHexAsVRS(signature);\n    if (_.includes(validVParamValues, ecSignatureVRS.v)) {\n        return ecSignatureVRS;\n    }\n    throw new Error(\"Invalid signature\");\n    function _parseSignatureHexAsVRS(signatureHex) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var signatureBuffer = ethUtil.toBuffer(signatureHex);\n        var v = signatureBuffer[0];\n        if (v < 27) {\n            v += 27;\n        }\n        var r = signatureBuffer.slice(1, 33);\n        var s = signatureBuffer.slice(33, 65);\n        var ecSignature = {\n            v: v,\n            r: ethUtil.bufferToHex(r),\n            s: ethUtil.bufferToHex(s),\n        };\n        return ecSignature;\n    }\n    function _parseSignatureHexAsRSV(signatureHex) {\n        var _a = ethUtil.fromRpcSig(signatureHex), v = _a.v, r = _a.r, s = _a.s;\n        var ecSignature = {\n            v: v,\n            r: ethUtil.bufferToHex(r),\n            s: ethUtil.bufferToHex(s),\n        };\n        return ecSignature;\n    }\n}\n/**\n * Estimates the price of an order\n * @param order The order to estimate price on\n * @param secondsToBacktrack The number of seconds to subtract on current time,\n *  to fix race conditions\n * @param shouldRoundUp Whether to round up fractional wei\n */\nfunction estimateCurrentPrice(order, secondsToBacktrack, shouldRoundUp) {\n    if (secondsToBacktrack === void 0) { secondsToBacktrack = 30; }\n    if (shouldRoundUp === void 0) { shouldRoundUp = true; }\n    var basePrice = order.basePrice, listingTime = order.listingTime, expirationTime = order.expirationTime, extra = order.extra;\n    var side = order.side, takerRelayerFee = order.takerRelayerFee, saleKind = order.saleKind;\n    var now = new bignumber_js_1.default(Math.round(Date.now() / 1000)).minus(secondsToBacktrack);\n    basePrice = new bignumber_js_1.default(basePrice);\n    listingTime = new bignumber_js_1.default(listingTime);\n    expirationTime = new bignumber_js_1.default(expirationTime);\n    extra = new bignumber_js_1.default(extra);\n    var exactPrice = basePrice;\n    if (saleKind === types_2.SaleKind.FixedPrice) {\n        // Do nothing, price is correct\n    }\n    else if (saleKind === types_2.SaleKind.DutchAuction) {\n        var diff = extra\n            .times(now.minus(listingTime))\n            .dividedBy(expirationTime.minus(listingTime));\n        exactPrice =\n            side == types_2.OrderSide.Sell\n                ? /* Sell-side - start price: basePrice. End price: basePrice - extra. */\n                    basePrice.minus(diff)\n                : /* Buy-side - start price: basePrice. End price: basePrice + extra. */\n                    basePrice.plus(diff);\n    }\n    // Add taker fee only for buyers\n    if (side === types_2.OrderSide.Sell && !order.waitingForBestCounterOrder) {\n        // Buyer fee increases sale price\n        exactPrice = exactPrice.times(+takerRelayerFee / constants_1.INVERSE_BASIS_POINT + 1);\n    }\n    return shouldRoundUp ? exactPrice.ceil() : exactPrice;\n}\nexports.estimateCurrentPrice = estimateCurrentPrice;\n/**\n * Get the Wyvern representation of a fungible asset\n * @param schema The WyvernSchema needed to access this asset\n * @param asset The asset to trade\n * @param quantity The number of items to trade\n */\nfunction getWyvernAsset(schema, asset, quantity) {\n    if (quantity === void 0) { quantity = new bignumber_js_1.default(1); }\n    var tokenId = asset.tokenId != null ? asset.tokenId.toString() : undefined;\n    return schema.assetFromFields({\n        ID: tokenId,\n        Quantity: quantity.toString(),\n        Address: asset.tokenAddress.toLowerCase(),\n        Name: asset.name,\n    });\n}\nexports.getWyvernAsset = getWyvernAsset;\n/**\n * Get the Wyvern representation of a group of assets\n * Sort order is enforced here. Throws if there's a duplicate.\n * @param assets Assets to bundle\n * @param schemas The WyvernSchemas needed to access each asset, respectively\n * @param quantities The quantity of each asset to bundle, respectively\n */\nfunction getWyvernBundle(assets, schemas, quantities) {\n    if (assets.length != quantities.length) {\n        throw new Error(\"Bundle must have a quantity for every asset\");\n    }\n    if (assets.length != schemas.length) {\n        throw new Error(\"Bundle must have a schema for every asset\");\n    }\n    var wyAssets = assets.map(function (asset, i) {\n        return getWyvernAsset(schemas[i], asset, quantities[i]);\n    });\n    var sorters = [\n        function (assetAndSchema) {\n            return assetAndSchema.asset.address;\n        },\n        function (assetAndSchema) {\n            return assetAndSchema.asset.id || 0;\n        },\n    ];\n    var wyAssetsAndSchemas = wyAssets.map(function (asset, i) { return ({\n        asset: asset,\n        schema: schemas[i].name,\n    }); });\n    var uniqueAssets = _.uniqBy(wyAssetsAndSchemas, function (group) { return \"\".concat(sorters[0](group), \"-\").concat(sorters[1](group)); });\n    if (uniqueAssets.length != wyAssetsAndSchemas.length) {\n        throw new Error(\"Bundle can't contain duplicate assets\");\n    }\n    var sortedWyAssetsAndSchemas = _.sortBy(wyAssetsAndSchemas, sorters);\n    return {\n        assets: sortedWyAssetsAndSchemas.map(function (group) { return group.asset; }),\n        schemas: sortedWyAssetsAndSchemas.map(function (group) { return group.schema; }),\n    };\n}\nexports.getWyvernBundle = getWyvernBundle;\n/**\n * Get the non-prefixed hash for the order\n * (Fixes a Wyvern typescript issue and casing issue)\n * @param order order to hash\n */\nfunction getOrderHash(order) {\n    var orderWithStringTypes = __assign(__assign({}, order), { maker: order.maker.toLowerCase(), taker: order.taker.toLowerCase(), feeRecipient: order.feeRecipient.toLowerCase(), side: order.side.toString(), saleKind: order.saleKind.toString(), howToCall: order.howToCall.toString(), feeMethod: order.feeMethod.toString() });\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return wyvern_js_1.WyvernProtocol.getOrderHashHex(orderWithStringTypes);\n}\nexports.getOrderHash = getOrderHash;\n/**\n * Assign an order and a new matching order to their buy/sell sides\n * @param order Original order\n * @param matchingOrder The result of _makeMatchingOrder\n */\nfunction assignOrdersToSides(order, matchingOrder) {\n    var isSellOrder = order.side == types_2.OrderSide.Sell;\n    var buy;\n    var sell;\n    if (!isSellOrder) {\n        buy = order;\n        sell = __assign(__assign({}, matchingOrder), { v: buy.v, r: buy.r, s: buy.s });\n    }\n    else {\n        sell = order;\n        buy = __assign(__assign({}, matchingOrder), { v: sell.v, r: sell.r, s: sell.s });\n    }\n    return { buy: buy, sell: sell };\n}\nexports.assignOrdersToSides = assignOrdersToSides;\n/**\n * Delay using setTimeout\n * @param ms milliseconds to wait\n */\nfunction delay(ms) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, new Promise(function (res) { return setTimeout(res, ms); })];\n        });\n    });\n}\nexports.delay = delay;\n/**\n * Validates that an address exists, isn't null, and is properly\n * formatted for Wyvern and OpenSea\n * @param address input address\n */\nfunction validateAndFormatWalletAddress(web3, address) {\n    if (!address) {\n        throw new Error(\"No wallet address found\");\n    }\n    if (!web3.isAddress(address)) {\n        throw new Error(\"Invalid wallet address\");\n    }\n    if (address == constants_1.NULL_ADDRESS) {\n        throw new Error(\"Wallet cannot be the null address\");\n    }\n    return address.toLowerCase();\n}\nexports.validateAndFormatWalletAddress = validateAndFormatWalletAddress;\n/**\n * Notify developer when a pattern will be deprecated\n * @param msg message to log to console\n */\nfunction onDeprecated(msg) {\n    console.warn(\"DEPRECATION NOTICE: \".concat(msg));\n}\nexports.onDeprecated = onDeprecated;\n/**\n * Get special-case approval addresses for an erc721 contract\n * @param erc721Contract contract to check\n */\nfunction getNonCompliantApprovalAddress(erc721Contract, tokenId, _accountAddress) {\n    return __awaiter(this, void 0, void 0, function () {\n        var results;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, Promise.all([\n                        // CRYPTOKITTIES check\n                        promisifyCall(function (c) {\n                            return erc721Contract.kittyIndexToApproved.call(tokenId, c);\n                        }),\n                        // Etherbots check\n                        promisifyCall(function (c) {\n                            return erc721Contract.partIndexToApproved.call(tokenId, c);\n                        }),\n                    ])];\n                case 1:\n                    results = _a.sent();\n                    return [2 /*return*/, _.compact(results)[0]];\n            }\n        });\n    });\n}\nexports.getNonCompliantApprovalAddress = getNonCompliantApprovalAddress;\n//# sourceMappingURL=utils.js.map"]},"metadata":{},"sourceType":"script"}